- name: Synchronize package database and install packages
  community.general.pacman:
    name:
      - git
      - ninja
      - vim
      - vivaldi
      - alacritty
      - exa
      - zoxide
      - fzf
      - ninja
      - cmake
      - unzip
      - zellij
      - telegram-desktop
      - fd
      - ripgrep
      - wl-clipboard
      - ttf-noto-nerd
      - yamllint
      - ansible-lint
      - nodejs
      - npm
      - yaml-language-server
      - ansible-language-server
      - rustup
      - go
      - lua-language-server
      - opera
      - nushell
      - gopls
      - shellcheck
      - docker
      - docker-buildx
    state: latest
    update_cache: true
  become: true

- name: Clone .dotfiles repository
  ansible.builtin.git:
    repo: 'https://github.com/Doodler8888/.dotfiles.git'
    dest: "{{ ansible_env.HOME }}/.dotfiles"
    version: "master"

- name: Soft link directories
  vars:
    directories_to_link:
      - zellij
      - nvim
      - alacritty
      - hyprland
  ansible.builtin.file:
    src: "{{ ansible_env.HOME }}/.dotfiles/{{ item }}"
    dest: "{{ ansible_env.HOME }}/.config/{{ item }}"
    state: link
  loop: "{{ directories_to_link }}"

- name: Link rc files
  vars:
    rc_files:
      - zsh/.zshrc
      - bash/.bashrc
      - bash/.inputrc
  ansible.builtin.file:
    src: "{{ ansible_env.HOME }}/.dotfiles/{{ item }}"
    dest: "{{ ansible_env.HOME }}"
    state: link
  loop: "{{ rc_files }}"


# -y: Refresh the package database, ensuring you have the latest package lists. This is the equivalent of update_cache: true in the Ansible module.
# -u: Upgrade all packages to their latest versions. When combined with -S, it
# applies to the specified package(s), making sure they are upgraded to the
# latest version, which corresponds to state: latest in the Ansible module.
